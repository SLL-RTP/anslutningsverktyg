<div class="container-fluid">
  <div class="page-header">
    <h1>Tjänsteproducent: Anslut till nya tjänstekontrakt
    </h1>
    <p>"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
      Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
      Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
      Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</p>
  </div>

  <!-- välj tjänsteproducent panel -->
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">Välj tjänsteproducent</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-5">
          <div class="row">
            <div class="form-group">
              <ui-select ng-model="selectedServiceComponent.selected" theme="bootstrap" reset-search-input="false" ng-disabled="newComponent">
                <ui-select-match placeholder="Sök befintlig tjänsteproducent">{{$select.selected.namn}} - {{$select.selected.hsaId}}</ui-select-match>
                <ui-select-choices
                  repeat="serviceComponent in filteredServiceComponents | filter: $select.search"
                  refresh="filterServiceComponents($select.search)"
                  refresh-delay="200"
                  >
                  <div ng-bind-html="(serviceComponent.namn + ' - ' + serviceComponent.hsaId) | highlight: $select.search"></div>
                </ui-select-choices>
              </ui-select>
            </div>

          </div>
        </div>
        <div class="col-md-7">
          <div class="form-group">
            <button ng-hide="newComponent" type="button" class="btn btn-primary" ng-click="newComponent = true">Anslut ny tjänsteproducent</button>
            <button ng-show="newComponent" type="button" class="btn btn-primary" ng-click="newComponent = false">Sök befintlig tjänsteproducent</button>
          </div>
        </div>
      </div>
      <form role="form" ng-show="newComponent || selectedServiceComponent.selected" name="serviceComponentForm">
        <div class="row">

          <div class="col-md-5">
            <div class="row" ng-show="newComponent">
              <div class="form-group" show-errors>
                <label class="control-label" for="komponentNamnInput">Tjänstekomponentens namn</label>
                <input type="text" class="form-control" id="komponentNamnInput" name="komponentNamn" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.namn" required>
                <span class="help-block" ng-if="serviceComponentForm.komponentNamn.$error.required">Namn för ny tjänstekomponent måste vara ifyllt</span>
              </div>
            </div>


            <div class="row" ng-show="newComponent">
              <div class="form-group" show-errors>
                <label class="control-label" for="hsaIdInput">HSA-ID</label>
                <input type="text" class="form-control" id="hsaIdInput" name="hsaId" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.hsaId" required>
                <span class="help-block" ng-if="serviceComponentForm.hsaId.$error.required">HsaId måste vara ifyllt</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="organisationInput">Organisation</label>
                <input type="text" class="form-control" id="organisationInput" name="organisation" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.organisation" required>
                <span class="help-block" ng-if="serviceComponentForm.organisation.$error.required">Organisation måste vara ifyllt</span>
              </div>
            </div>

            <div class="row">
              <h4>Huvudansvarig</h4>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="huvudansvarigNamnInput">För- och efternamn</label>
                <input type="text" class="form-control" id="huvudansvarigNamnInput" name="huvudAnsvarig" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.huvudAnsvarigNamn" required>
                <span class="help-block" ng-if="serviceComponentForm.huvudAnsvarig.$error.required">För- och efternamn måste vara ifyllt</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="huvudansvarigEmailInput">E-postadress</label>
                <input type="email" class="form-control" id="huvudansvarigEmailInput" name="huvudAnsvarigEmail"
                       placeholder="" ng-model="connectServiceProducerRequest.serviceComponent.huvudAnsvarigEpost" required>
                <span class="help-block" ng-if="serviceComponentForm.huvudAnsvarigEmail.$error.required">E-postadress måste vara ifyllt</span>
                <span class="help-block" ng-if="serviceComponentForm.huvudAnsvarigEmail.$error.email">E-postadress är ej giltig</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="huvudansvarigTelefonInput">Telefon</label>
                <input type="text" class="form-control" id="huvudansvarigTelefonInput" name="huvudansvarigTelefon" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.huvudAnsvarigTelefon" required>
                <span class="help-block" ng-if="serviceComponentForm.huvudansvarigTelefon.$error.required">Telefonnummer måste vara ifyllt</span>
              </div>
            </div>

            <div class="row">
              <h4>Teknisk support</h4>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="brevladaEmailInput">Funktionsbrevlåda</label>
                <input type="email" class="form-control" id="brevladaEmailInput" name="brevladaEmail"
                       placeholder="" ng-model="connectServiceProducerRequest.serviceComponent.funktionsBrevladaEpost" required>
                <span class="help-block" ng-if="serviceComponentForm.brevladaEmail.$error.required">E-postadress måste vara ifyllt</span>
                <span class="help-block" ng-if="serviceComponentForm.brevladaEmail.$error.email">E-postadress är ej giltig</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="brevladaTelefonInput">Telefon</label>
                <input type="text" class="form-control" id="brevladaTelefonInput" name="brevladaTelefon"
                       placeholder="" ng-model="connectServiceProducerRequest.serviceComponent.funktionsBrevladaTelefon" required>
                <span class="help-block" ng-if="serviceComponentForm.brevladaTelefon.$error.required">Telefonnummer måste vara ifyllt</span>
              </div>
            </div>
          </div>

          <div class="col-md-5 col-md-offset-2">
            <div class="row">
              <h4>Teknisk kontaktperson</h4>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="kontaktNamnInput">För- och efternamn</label>
                <input type="text" class="form-control" id="kontaktNamnInput" name="kontaktNamn" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.tekniskKontaktNamn" required>
                <span class="help-block" ng-if="serviceComponentForm.kontaktNamn.$error.required">För- och efternamn måste vara ifyllt</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="kontaktMailInput">E-postadress</label>
                <input type="email" class="form-control" id="kontaktMailInput" name="kontaktMail" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.tekniskKontaktEpost" required>
                <span class="help-block" ng-if="serviceComponentForm.kontaktMail.$error.required">E-postadress måste vara ifyllt</span>
                <span class="help-block" ng-if="serviceComponentForm.kontaktMail.$error.email">E-postadress är ej giltig</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="kontaktTelefonInput">Telefon</label>
                <input type="text" class="form-control" id="kontaktTelefonInput" name="kontaktTelefon" placeholder=""
                       ng-model="connectServiceProducerRequest.serviceComponent.tekniskKontaktTelefon" required>
                <span class="help-block" ng-if="serviceComponentForm.kontaktTelefon.$error.required">Telefonnummer måste vara ifyllt</span>
              </div>
            </div>

            <div class="row">
              <h4>Teknisk information</h4>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="ipAddressInput">IP-adress</label>
                <input type="text" class="form-control" id="ipAddressInput" name="ipAddress"
                       placeholder="" ng-model="connectServiceProducerRequest.serviceComponent.ipadress" required>
                <span class="help-block" ng-if="serviceComponentForm.ipAddress.$error.required">IP-adress måste vara ifyllt</span>
              </div>
            </div>

            <div class="row">
              <div class="form-group" show-errors>
                <label class="control-label" for="pingForConfigurationInput">URL till övervakningstjänst</label>
                <input type="url" class="form-control" id="pingForConfigurationInput" name="pingForConfiguration"
                       placeholder="" ng-model="connectServiceProducerRequest.serviceComponent.pingForConfiguration" required>
                <span class="help-block" ng-if="serviceComponentForm.pingForConfiguration.$error.required">URL måste vara ifyllt</span>
                <span class="help-block" ng-if="serviceComponentForm.pingForConfiguration.$error.url">URL är ej korrekt</span>
              </div>
            </div>
          </div>

        </div>

      </form>
    </div>
  </div>
  <!-- / välj tjänsteproducent panel -->
  <!-- välj driftmiljö panel -->
  <div class="panel panel-primary" ng-show="connectServiceProducerRequest.serviceComponent.hsaId && connectServiceProducerRequest.serviceComponent.namn">
    <div class="panel-heading">
      <h3 class="panel-title">Välj driftmiljö</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-5 form-group">
          <label for="environment">Driftmiljö</label>
          <select id="environment" class="form-control" ng-model="selectedTargetEnvironment" ng-change="targetEnvironmentSelected()" ng-options="environment.namn for environment in targetEnvironments">
            <option value="">Välj driftmiljö</option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <!-- / välj driftmiljö panel -->
  <!-- välj tjänstekontrakt panel -->
  <div class="panel panel-primary" ng-show="connectServiceProducerRequest.serviceComponent.hsaId && connectServiceProducerRequest.serviceComponent.namn && selectedTargetEnvironment.id">
    <div class="panel-heading">
      <h3 class="panel-title">Välj tjänstekontrakt</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-5 form-group">
          <label for="service-domain">Tjänstedomän eller informationsmängd</label>
          <select class="form-control" ng-model="selectedServiceDomain" ng-change="serviceDomainSelected()" ng-options="serviceDomain.tjansteDomanId for serviceDomain in serviceDomains" id="service-domain">
            <option value="">Välj tjänstedomän</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div ui-grid="gridOptions" ui-grid-selection class="grid"></div>
        </div>
      </div>
    </div>
  </div>
  <!-- / välj tjänstekontrakt panel -->
  <!-- konfigurera tjänstekontrakt panel -->
  <div class="panel panel-primary" ng-show="connectServiceProducerRequest.serviceComponent && connectServiceProducerRequest.serviceContracts.length">
    <div class="panel-heading">
      <h3 class="panel-title">Konfigurera tjänstekontrakt</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-12">
          <p>Lägg till de logiska adresser som en konsument ska kunna adressera. Vad som används som logisk adress beror på vilken tjänstedomän beställningen gäller.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="radio">
            <label>
              <input ng-model="linkLogicalAddressChoice" value="sameForAllContracts" type="radio" name="linkLogicalAddressChoiceRadios" id="optionsRadios1">
              Lägg till samma logiska adresser för alla tjänstekontrakt
            </label>
          </div>
          <div class="radio">
            <label>
              <input ng-model="linkLogicalAddressChoice" value="individualForContract" type="radio" name="linkLogicalAddressChoiceRadios" id="optionsRadios2">
              Lägg till logiska adresser individuellt för varje tjänstekontrakt
            </label>
          </div>
          <div class="radio">
            <label>
              <input ng-model="linkLogicalAddressChoice" value="sourceSystemBased" type="radio" name="linkLogicalAddressChoiceRadios" id="optionsRadios3">
              Källsystemsbaserad addressering tillämpas och den logiska adressen är densamma
              som Tjänsteproducenten
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- / konfigurera tjänstekontrakt panel -->
  <!-- samma logiska adresser panel -->
  <div class="panel panel-primary" ng-show="connectServiceProducerRequest.serviceComponent && connectServiceProducerRequest.serviceContracts.length && linkLogicalAddressChoice === 'sameForAllContracts' || linkLogicalAddressChoice === 'sourceSystemBased'">
    <div class="panel-heading">
      <h3 class="panel-title">Lägg till samma logiska adresser för alla tjänstekontrakt</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-12">
          <div class="col-md-4">
            <div class="row">
              <div class="form-group">
                <label>Sök efter HSA-ID</label>
                <ui-select  ng-model="selectedLogicalAddress.selected" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'" theme="bootstrap"
                            reset-search-input="true">
                  <ui-select-match placeholder="Namn - HSA ID">{{$select.selected.namn}} - {{$select.selected.hsaId}}</ui-select-match>
                  <ui-select-choices repeat="logicalAddress in filteredLogicalAddresses| filter: $select.search"
                                     refresh="filterLogicalAddresses($select.search)" refresh-delay="200">
                    <div ng-bind-html="logicalAddress.namn | highlight: $select.search"></div>
                  </ui-select-choices>
                </ui-select>
              </div>
            </div>

            <div class="row">
              <label>Lägg till ny logisk address</label>
              <div class="form-group">
                <input ng-model="newLogicalAddress.hsaId" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'" type="text" class="form-control" id="newLogicalAddress_HSAID"
                       placeholder="HSA ID">
              </div>
            </div>

            <div class="row">
              <div class="form-group">
                <input ng-model="newLogicalAddress.namn" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'" type="text" class="form-control" id="newLogicalAddress_Name"
                       placeholder="Namn">
              </div>
            </div>

            <!-- befintliga logiska adresser bortkommenterade tills vidare -->
            <!--<div class="row">-->
            <!--<div class="form-group">-->
            <!--<label for="selectExistingLogicalAddresses">Välj från befintliga logiska adresser</label>-->
            <!--<select multiple ng-multiple="true" ng-model="selectedExistingLogicalAddresses" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'"-->
            <!--ng-options="logicalAddress.namn +' - '+logicalAddress.hsaId for logicalAddress in existingLogicalAddresses"-->
            <!--class="form-control" id="selectExistingLogicalAddresses">-->
            <!--</select>-->
            <!--</div>-->
            <!--</div>-->

          </div>

          <div class="col-md-2 col-md-offset-1">
            <div class="row">

              <div class="form-group top25">
                <div class="btn-group">
                  <button type="button" class="btn btn-primary" ng-click="addLogicalAddressToAllServiceContracts(selectedLogicalAddress.selected)" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'">
                    <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>
                  </button>
                </div>
              </div>

            </div>

            <div class="row">

              <div class="form-group top45">
                <div class="btn-group">
                  <button type="button" class="btn btn-primary" ng-click="addLogicalAddressToAllServiceContracts(newLogicalAddress); newLogicalAddress = {};" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'">
                    <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>
                  </button>
                </div>
              </div>

            </div>
            <!-- befintliga logiska adresser bortkommenterade tills vidare -->
            <!--<div class="row">-->
            <!--<div class="form-group top75">-->
            <!--<div class="btn-group">-->
            <!--<button type="button" class="btn btn-default" ng-click="addLogicalAddressesToAllServiceContracts(selectedExistingLogicalAddresses)" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'">-->
            <!--<label>Valda</label> <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>-->
            <!--</button>-->
            <!--</div>-->
            <!--</div>-->

            <!--</div>-->

            <!--<div class="row">-->
            <!--<div class="form-group top17">-->
            <!--<div class="btn-group">-->
            <!--<button type="button" class="btn btn-default" ng-click="addLogicalAddressesToAllServiceContracts(existingLogicalAddresses)" ng-disabled="linkLogicalAddressChoice === 'sourceSystemBased'">-->
            <!--<label>Alla</label> <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>-->
            <!--</button>-->
            <!--</div>-->
            <!--</div>-->

            <!--</div>-->
          </div>

          <div class="form-group col-md-5">
            <label>Valda logiska adresser</label>
            <div class="alert alert-dismissable alert-success logical-address new-logical-address" ng-repeat="logicalAddress in logicalAddresses">
              <button type="button" class="close" data-dismiss="alert" ng-click="removeLogicalAddressFromAllServiceContracts(logicalAddress)" ng-hide="linkLogicalAddressChoice === 'sourceSystemBased'">×</button>
              {{logicalAddress.namn}}
            </div>
            <p ng-hide="logicalAddresses.length">
              <em>inga logiska adresser valda</em>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- / samma logiska adresser panel -->
  <!-- enskilda tjänstekontrakt panel(er) -->
  <div class="panel panel-primary"
       ng-show="connectServiceProducerRequest.serviceComponent && connectServiceProducerRequest.serviceContracts.length"
       ng-repeat="contract in connectServiceProducerRequest.serviceContracts">
    <div class="panel-heading">
      <h3 class="panel-title" ng-show="linkLogicalAddressChoice === 'sameForAllContracts'">Välj RIVTA-profil och URL för {{contract.namn}} {{contract.majorVersion}}.{{contract.minorVersion}}</h3>
      <h3 class="panel-title" ng-show="linkLogicalAddressChoice === 'individualForContract'">Välj RIVTA-profil, URL och logiska adresser för {{contract.namn}} {{contract.majorVersion}}.{{contract.minorVersion}}</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-12">
          <form name="serviceContractForm">
            <div class="col-md-3">
              <label for="rivtaVersion">RIVTA-profil</label>
              <select id="rivtaVersion" class="form-control" ng-model="contract.rivtaVersion"
                      ng-options="rivtaVersion.name for rivtaVersion in rivtaVersions | orderBy:'name':true"
                      ng-init="contract.rivtaVersion = (rivtaVersions | orderBy:'name':true)[0]"></select>
            </div>
            <div class="form-group" show-errors>
              <div class="col-md-9">
                <label class="control-label" for="urlInput">URL</label>
                <input type="url" class="form-control" id="urlInput" name="url" ng-model="contract.url" placeholder="skriv in url" required>
                <span class="help-block" ng-if="serviceContractForm.url.$error.required">Url måste vara ifyllt</span>
                <span class="help-block" ng-if="serviceContractForm.url.$error.url">Url är ej korrekt</span>
              </div>
            </div>
          </form>
        </div>
      </div>
      <div ng-show="linkLogicalAddressChoice === 'individualForContract'" class="row">
        <div class="col-md-12">
          <div class="col-md-4">
            <div class="row">
              <div class="form-group">
                <label>Sök efter HSA-ID</label>
                <ui-select ng-model="$parent.selectedLogicalAddress" theme="bootstrap"
                           reset-search-input="true">
                  <ui-select-match placeholder="Namn - HSA ID">{{$select.selected.namn}} - {{$select.selected.hsaId}}</ui-select-match>
                  <ui-select-choices repeat="logicalAddress in filteredLogicalAddresses| filter: $select.search"
                                     refresh="filterLogicalAddresses($select.search)" refresh-delay="200">
                    <div ng-bind-html="logicalAddress.namn | highlight: $select.search"></div>
                  </ui-select-choices>
                </ui-select>
              </div>

            </div>

            <div class="row">
              <label>Lägg till ny logisk address</label>
              <div class="form-group">
                <input ng-model="newLogicalAddress.hsaId" type="text" class="form-control" id="newLogicalAddress_HSAID_{{$index}}"
                       placeholder="HSA ID">
              </div>
            </div>

            <div class="row">
              <div class="form-group">
                <input ng-model="newLogicalAddress.namn" type="text" class="form-control" id="newLogicalAddress_Name_{{$index}}"
                       placeholder="Namn">
              </div>
            </div>

            <!-- befintliga logiska adresser bortkommenterade tills vidare -->
            <!--<div class="row">-->
            <!--<div class="form-group">-->
            <!--<label for="selectExistingLogicalAddresses-{{$index}}">Välj från befintliga logiska adresser</label>-->
            <!--<select multiple ng-multiple="true" ng-model="selectedExistingLogicalAddresses"-->
            <!--ng-options="logicalAddress.namn +' - '+logicalAddress.hsaId for logicalAddress in existingLogicalAddresses"-->
            <!--class="form-control" id="selectExistingLogicalAddresses-{{$index}}">-->
            <!--</select>-->
            <!--</div>-->
            <!--</div>-->

          </div>

          <div class="col-md-2 col-md-offset-1">
            <div class="row">
              <div class="form-group top25">
                <div class="btn-group">
                  <button type="button" class="btn btn-primary" ng-click="addLogicalAddressToServiceContract(this.selectedLogicalAddress, contract)">
                    <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>
                  </button>
                  <!--<button type="button" class="btn btn-default" ng-click="addFilteredLogicalAddressToServiceContract(this, contract)">-->
                  <!--<span class="glyphicon glyphicon-forward" aria-hidden="true"></span>-->
                  <!--</button>-->
                </div>
              </div>
            </div>

            <div class="row">
              <div class="form-group top45">
                <div class="btn-group">
                  <button type="button" class="btn btn-primary" ng-click="addLogicalAddressToServiceContract(newLogicalAddress, contract); newLogicalAddress = {};">
                    <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>
                  </button>
                  <!--<button type="button" class="btn btn-default" ng-click="addNewLogicalAddressToServiceContract(this, contract)">-->
                  <!--<span class="glyphicon glyphicon-forward" aria-hidden="true"></span>-->
                  <!--</button>-->
                </div>
              </div>
            </div>


            <!-- befintliga logiska adresser bortkommenterade tills vidare -->
            <!--<div class="row">-->
            <!--<div class="form-group top75">-->
            <!--<div class="btn-group">-->
            <!--<button type="button" class="btn btn-default" ng-click="addLogicalAddressesToServiceContract(this.selectedExistingLogicalAddresses, contract)">-->
            <!--<label>Valda</label> <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>-->
            <!--</button>-->
            <!--</div>-->
            <!--</div>-->

            <!--</div>-->

            <!--<div class="row">-->
            <!--<div class="form-group top17">-->
            <!--<div class="btn-group">-->
            <!--<button type="button" class="btn btn-default" ng-click="addLogicalAddressesToServiceContract(existingLogicalAddresses, contract)">-->
            <!--<label>Alla</label> <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>-->
            <!--</button>-->
            <!--</div>-->
            <!--</div>-->

            <!--</div>-->
          </div>

          <div class="form-group col-md-5">
            <label>Valda logiska adresser</label>
            <div class="alert alert-dismissable alert-success logical-address new-logical-address" ng-repeat="logicalAddress in contract.logicalAddresses">
              <button type="button" class="close" data-dismiss="alert" ng-click="removeLogicalAddressFromServiceContract(logicalAddress, contract)">×</button>
              {{logicalAddress.namn}}
            </div>
            <p ng-hide="contract.logicalAddresses.length">
              <em>inga logiska adresser valda</em>
            </p>
          </div>

        </div>

      </div>
    </div>
  </div>
  <!-- / enskilda tjänstekontrakt panel(er) -->
  <!-- anropsbehörighet panel -->
  <div class="panel panel-primary" ng-show="connectServiceProducerRequest.serviceComponent && connectServiceProducerRequest.serviceContracts.length">
    <div class="panel-heading">
      <h3 class="panel-title">Lägg till anropsbehörighet för tjänstekonsument</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-12">
          <p>För att anslutningen ska fungera mellan tjänstekonsument och tjänsteproducent måste även tjänstekonsumenten vara ansluten till tjänstekontraten, samt ha anropsbehörighet till de logiska adresserna.
            Om tjänstekonsumenten redan är ansluten till kontrakten kan du i detta flöde även begära anropsbehörighet för tjänstekonsumenten till de logiska adresserna du angivit för respektive tjänstekontrakt.</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <div class="radio">
            <label>
              <input ng-model="requestForCallPermissionInSeparateOrder" ng-value="true" type="radio" name="callPermissionRadios"
                     id="callPermissionRadios1" ng-change="requestForCallPermissionClicked()">
              Anropsbehörighet kommer begäras via en konsumentanslutningsbeställning
            </label>
          </div>
          <div class="radio">
            <label>
              <input ng-model="requestForCallPermissionInSeparateOrder" ng-value="false" type="radio" name="callPermissionRadios" id="callPermissionRadios2">
              Anropsbehörighet ska begäras i samband med denna beställning
            </label>
          </div>
        </div>
      </div>
      <div class="row" ng-show="!requestForCallPermissionInSeparateOrder ">
        <div class="col-md-4">
          <ui-select ng-model="selectedServiceConsumer.selected" theme="bootstrap" reset-search-input="true" on-select="onSelectServiceConsumer($item, $model)">
            <ui-select-match placeholder="Välj tjänstekonsument">{{$select.selected.namn}} -
              {{$select.selected.hsaId}}
            </ui-select-match>
            <ui-select-choices
              repeat="serviceConsumer in filteredServiceConsumers | filter: $select.search"
              refresh="filterServiceConsumers($select.search)"
              refresh-delay="200"
              >
              <div
                ng-bind-html="(serviceConsumer.namn + ' - ' + serviceConsumer.hsaId) | highlight: $select.search"></div>
            </ui-select-choices>
          </ui-select>
        </div>
      </div>
      <div class="row" ng-show="!requestForCallPermissionInSeparateOrder && selectedServiceConsumer.selected.namn">
        <div class="col-md-12">
          <p>Denna tjänstekonsument ({{selectedServiceConsumer.selected.namn}}) ska få anropsbehörighet för valda tjänstekontrakt på de valda logiska adresser.</p>
        </div>
      </div>
    </div>
  </div>
  <!-- / anropsbehörighet panel -->
  <!-- övrigt panel -->
  <div class="panel panel-primary" ng-show="connectServiceProducerRequest.serviceComponent && connectServiceProducerRequest.serviceContracts.length">
    <div class="panel-heading">
      <h3 class="panel-title">Övrigt</h3>
    </div>
    <div class="panel-body">
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="form-group">
              <label for="ovrigInformation">Övrig information</label>
              <textarea ng-model="connectServiceProducerRequest.otherInfo" id="ovrigInformation" class="form-control"
                        cols="30" rows="10"></textarea>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <h4>Beställare</h4>
      </div>
      <form name="bestallareForm" role="form">
        <div class="row">
          <div class="col-md-4">
            <div class="row">
              <div class="form-group" show-errors>
                <label class=" control-label" for="bestallareNamnInput">För- och efternamn</label>
                <input ng-model="connectServiceProducerRequest.client.name"
                       type="text" class="form-control" id="bestallareNamnInput" name="bestallareNamn"
                       placeholder="" required>
                <span class="help-block" ng-if="bestallareForm.bestallareNamn.$error.required">För- och efternamn måste vara ifyllt</span>
              </div>
            </div>
            <div class="row">
              <div class="form-group" show-errors>
                <label for="bestallareEmailInput" class="control-label">E-postadress</label>
                <input ng-model="connectServiceProducerRequest.client.email" type="email" class="form-control"
                       id="bestallareEmailInput" name="bestallareMail" placeholder="" required>
                <span class="help-block" ng-if="bestallareForm.bestallareMail.$error.required">E-postadress måste vara ifyllt</span>
                <span class="help-block" ng-if="bestallareForm.bestallareMail.$error.email">E-postadress är ej giltig</span>
              </div>
            </div>
            <div class="row">
              <div class="form-group" show-errors>
                <label for="bestallareTelefonInput" class="control-label">Telefon</label>
                <input ng-model="connectServiceProducerRequest.client.phone" type="text" class="form-control"
                       id="bestallareTelefonInput" name="bestallareTelefon" placeholder="" required>
                <span class="help-block" ng-if="bestallareForm.bestallareTelefon.$error.required">Telefon måste vara ifyllt</span>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <!-- / övrigt panel -->
  <div class="row" ng-show="!orderValid && connectServiceProducerRequest.serviceComponent && connectServiceProducerRequest.serviceContracts.length">
    <div class="col-md-4 col-md-offset-8">
      <div class="alert alert-dismissable alert-danger">
        <button type="button" class="close" data-dismiss="alert">×</button>
        Det finns fel i beställningen som behöver rättas till!
      </div>
    </div>
  </div>
  <div class="row" ng-show="connectServiceProducerRequest.serviceComponent && connectServiceProducerRequest.serviceContracts.length">
    <div class="col-md-4 col-md-offset-8">
      <button type="button" class="btn btn-primary btn-lg btn-wrap pull-right" ng-click="sendServiceProducerConnectionOrder()">Bekräfta</button>
    </div>
  </div>


  <h3 ng-show="showDevStuff">sammanfattning:</h3>
  <div ng-show="showDevStuff" class="jumbotron">
    <pre>
        {{connectServiceProducerRequest | json}}
    </pre>
  </div>
</div>
